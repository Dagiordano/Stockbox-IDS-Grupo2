{% extends "base.html" %}

{% block title %}Historial de Movimientos{% endblock %}

{% block content %}
<div class="container mx-auto p-4">
    <div class="flex items-center justify-between mb-6">
        <h1 class="text-2xl font-semibold">Historial de Movimientos Recientes</h1>
        <a href="{% url 'crear_movimiento' %}" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
            Crear Movimiento
        </a>
    </div>

    <div class="bg-white shadow-md rounded-lg overflow-hidden">
        <table class="min-w-full leading-normal">
            <thead>
                <tr>
                    <th class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Fecha</th>
                    <th class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Producto</th>
                    <th class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Motivo</th>
                    <th class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Cantidad</th>
                    <th class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Usuario</th>
                </tr>
            </thead>
            <tbody>
                {% for movimiento in movimientos %}
                <tr>
                    <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">{{ movimiento.fecha|date:"Y-m-d H:i" }}</td>
                    <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm font-medium">{{ movimiento.prenda_bodega.prenda }}</td>
                    <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
                        <span class="relative inline-block px-3 py-1 font-semibold leading-tight {% if movimiento.motivo == 'ADD' %}text-green-900{% else %}text-red-900{% endif %}">
                            <span aria-hidden class="absolute inset-0 {% if movimiento.motivo == 'ADD' %}bg-green-200{% else %}bg-red-200{% endif %} opacity-50 rounded-full"></span>
                            <span class="relative">{{ movimiento.get_motivo_display }}</span>
                        </span>
                    </td>
                    <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm {% if movimiento.cantidad > 0 %}text-green-600{% else %}text-red-600{% endif %}">{{ movimiento.cantidad }}</td>
                    <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm text-gray-500">{{ movimiento.usuario.username }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5" class="text-center py-10 text-gray-500">No hay movimientos registrados.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
